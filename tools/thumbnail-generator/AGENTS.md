# AGENTS 안내

이 문서는 에이전트가 저장소에서 작업할 때 참고하는 기본 규칙입니다.
이 저장소는 Node.js 기반 썸네일 생성기입니다.

## 우선순위
- 사용자/시스템 지시가 최우선입니다.
- 이 문서는 해당 범위의 기본 규칙입니다.
- 새 규칙이 추가되면 최신 규칙을 따릅니다.

## Cursor/Copilot 규칙
- `.cursor/rules/`, `.cursorrules`, `.github/copilot-instructions.md` 파일이 없습니다.
- 별도의 에디터 규칙이 추가되면 이 섹션을 갱신합니다.

## 실행 환경
- Node.js ES 모듈(`"type": "module"`)을 사용합니다.
- 패키지 의존성 설치는 `npm install`을 사용합니다.
- 기본 진입점은 `generate.js`입니다.

## 빌드/실행 명령어
- `npm start`: `generate.js`로 로고/책표지 썸네일을 모두 생성합니다.
- `npm run generate`: `npm start`와 동일합니다.
- `npm run dev`: `node --watch generate.js`로 변경 감지 실행합니다.
- `node generate.js`: 로고/책표지 설정을 순차 실행합니다.

## Justfile 명령어
- `just generate`: 로고/책표지 썸네일을 생성합니다.
- `just --list`: 등록된 명령어 확인입니다.

## 테스트/린트/포맷
- 테스트 러너가 설정되어 있지 않습니다.
- 린트/포맷터 설정이 없습니다.
- 단일 테스트 실행 명령어가 존재하지 않습니다.
- 테스트/린트 도구를 추가할 경우 이 섹션에 명령어를 명시합니다.

## 주요 디렉터리
- `assets/logo`: 일반 로고 입력 파일을 보관합니다.
- `assets/book-cover`: 책 표지 입력 파일을 보관합니다.
- `output/logo`: 로고 PNG 썸네일 출력입니다.
- `output/book-cover`: 책 표지 PNG 썸네일 출력입니다.
- `config/`: 설정 파일 폴더입니다.

## 파일명 규칙
- 기본 형식: `{로고이름}-{배경색상}.{확장자}`
- 확장 형식: `{로고이름}-{로고색상}-{배경색상}.{확장자}`
- 구분자는 `config/logo.json`의 `fileConvention.separator`를 따릅니다.

## 코드 스타일: 일반
- 기존 파일의 스타일을 유지하면서 수정합니다.
- 들여쓰기는 2칸 공백을 사용합니다.
- 줄 끝 공백을 남기지 않습니다.
- 불필요한 빈 줄은 피합니다.
- 한 줄에 너무 긴 표현은 적절히 줄바꿈합니다.

## 코드 스타일: 모듈/임포트
- ES 모듈 `import/export` 문법을 사용합니다.
- 외부 라이브러리 → 내장 모듈 → 로컬 모듈 순서로 배치합니다.
- 경로는 파일 확장자를 명시합니다(예: `./auto-generator.js`).
- 동일 모듈 내의 import 순서를 임의로 변경하지 않습니다.

## 코드 스타일: 문자열/리터럴
- 파일별 기존 따옴표 스타일을 유지합니다.
- 새 파일을 만들 경우 더블 쿼트를 기본으로 사용합니다.
- 색상 값은 `#rrggbb` 형식으로 정규화합니다.
- 템플릿 문자열은 보간이 필요한 경우에만 사용합니다.

## 코드 스타일: 명명 규칙
- 클래스는 PascalCase를 사용합니다.
- 함수/메서드는 camelCase를 사용합니다.
- 상수는 대문자 스네이크 케이스를 사용합니다.
- 설정 키는 JSON에서 camelCase를 유지합니다.
- 불필요한 축약어는 피합니다.

## 코드 스타일: 타입과 구조
- 현재는 순수 JavaScript 프로젝트입니다.
- 타입스크립트 도입 전까지 JSDoc 사용은 선택 사항입니다.
- 공용 함수는 클래스 내부 메서드로 유지합니다.
- 설정 구조는 `config/logo.json` 스키마를 따릅니다.

## 비동기 처리
- 비동기 로직은 `async/await`를 우선 사용합니다.
- 에러는 `try/catch`로 처리하고 의미 있는 메시지를 제공합니다.
- 외부 호출(파일, 이미지 처리)은 반드시 예외 처리합니다.

## 에러 처리/로그
- 사용자에게 보여줄 메시지는 한국어로 작성합니다.
- 치명적 오류는 `process.exit(1)`로 종료합니다.
- 재사용 가능한 오류는 `throw new Error(...)`를 사용합니다.
- 경고/정보/성공 로그는 `chalk` 색상을 유지합니다.
- 로그 메시지 형식(아이콘, 접두어)을 임의로 변경하지 않습니다.

## 이미지 처리 규칙
- 이미지 처리는 `sharp`를 사용합니다.
- 리사이즈는 비율 유지(`fit: "inside"`)를 기본으로 합니다.
- PNG 출력 품질과 압축 설정을 존중합니다.
- SVG 색상 변경 로직은 정규식 기반 변경을 유지합니다.

## 경로/파일 처리
- 파일 시스템은 `fs/promises` 사용을 우선합니다.
- 경로 결합은 `path.join`을 사용합니다.
- 디렉터리 생성 시 `recursive: true`를 사용합니다.
- 출력 파일 존재 여부를 먼저 확인합니다.

## 설정 파일 처리
- 로고 설정은 `config/logo.json`, 책 표지 설정은 `config/book-cover.json`입니다.
- 실행 시 두 설정 파일을 순차 로드합니다.
- 커스텀 설정은 필요한 값만 오버라이드합니다.
- 설정 누락 시 기본값을 사용하도록 설계합니다.

## 함수 설계 가이드
- 메서드는 하나의 책임만 갖도록 유지합니다.
- 에러 메시지는 상황을 구체적으로 설명합니다.
- 입력 파라미터는 검증 후 사용합니다.
- 반환 객체는 호출자가 필요한 정보를 제공하도록 합니다.

## 변경 시 주의사항
- `output/`은 생성 결과이므로 소스 수정 대상이 아닙니다.
- `node_modules/`는 수정하지 않습니다.
- `assets/`의 샘플 파일은 자동 생성하지 않습니다.
- CLI 옵션을 추가하면 README와 이 파일을 갱신합니다.

## 문서 업데이트
- 사용법/옵션이 바뀌면 `README.md`를 함께 수정합니다.
- 설정 스키마 변경 시 예시 JSON도 업데이트합니다.
- 문서 내 코드는 실제 동작과 일치해야 합니다.

## 커밋/리뷰 참고
- 커밋 메시지는 변경 이유를 중심으로 작성합니다.
- 불필요한 리팩터링은 피합니다.
- 단위 변경 후 실행 가능한 명령어를 명시합니다.

## 단일 테스트 안내
- 현재 단일 테스트 실행 방법이 없습니다.
- 테스트 프레임워크가 추가되면 다음 형식으로 기재합니다.
- 예: `npm test -- <test-file>` 또는 `pnpm test <pattern>`

## 에이전트 행동 가이드
- 변경 전후로 기존 동작을 유지합니다.
- 최소 변경 원칙을 지킵니다.
- 새 의존성 추가 시 이유와 사용법을 문서화합니다.
- 외부 네트워크 호출은 필요 시 사용자 승인 후 진행합니다.

## 갱신 기록
- 2026-01-22: 최초 생성.
